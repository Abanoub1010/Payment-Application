/***********************************************************************************************************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/
/*****************************************    Author:  Abanoub Ashraf    ***********************************************/
/*****************************************    Date:    24 OCT 2022       ***********************************************/
/*****************************************    Module:  Card              ***********************************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/


#include <stdio.h>
#include <string.h>
#include "../Library/std_typs.h"
#include "card.h"

/***********************************************************************************************************************/
/***********************************************************************************************************************/
/**************************          Function Name:        getCardHolderName        ************************************/
/**************************          Input Arguments:      Pointer To Struct        ************************************/
/**************************          Output Arguments:     Object From Enum			************************************/
/**************************         												************************************/
/********************         Function Description: This function asks for the             *****************************/
/********************							    cardholder's name and store it 	       *****************************/
/********************		                        into the card data which is a pointer  *****************************/
/********************								to a structure has an array 		   *****************************/
/********************						        named (cardHolderName)                 *****************************/
/********************						        a temporary array made just to         *****************************/
/********************						        obtain a pre checks before saving      *****************************/
/********************						        it into the main array                 *****************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/

EN_cardError_t getCardHolderName(ST_cardData_t* cardData)
{
	uint8_t tempHolderName [30]={0};
	uint8_t i=0;
	uint8_t j=0;
	uint8_t flag=0;
	gets(tempHolderName);
	uint8_t holderSize= strlen(tempHolderName);
	
	
	if (holderSize>=20 && holderSize<=24)
	{
		
		for (i=0; i<holderSize ;i++)
		{
			if ((tempHolderName[i]>='a' && tempHolderName[i] <= 'z') ||
				(tempHolderName[i]>='A' && tempHolderName[i] <= 'Z') ||	
				(tempHolderName[i] == ' '))
			{
						
			}
			else 
			{
			 flag=1;
			}
		}
		
		if (flag==1)
		{
			
			return WRONG_NAME;	
		}
		else
		{
		for (j=0; j<=holderSize ;j++)
				{
					cardData->cardHolderName[j] = tempHolderName[j];
				}
				
				return OK;
		}
		
	}
	else
		{
			
			return WRONG_NAME;
		}
	
}

/***********************************************************************************************************************/
/***********************************************************************************************************************/
/**************************          Function Name:        getCardExpiryDate        ************************************/
/**************************          Input Arguments:      Pointer To Struct        ************************************/
/**************************          Output Arguments:     Object From Enum			************************************/
/**************************         												************************************/
/********************         Function Description: This function asks for the             *****************************/
/********************							    card expiry date and store it 	       *****************************/
/********************		                        into the card data which is a pointer  *****************************/
/********************								to a structure has an array 		   *****************************/
/********************						        named (cardExpirationDate).            *****************************/
/********************						        A temporary array made just to         *****************************/
/********************						        obtain a pre checks before saving      *****************************/
/********************						        it into the main array                 *****************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/

EN_cardError_t getCardExpiryDate(ST_cardData_t* cardData)
{
	uint8_t tempExpiryDate [6]={0};
	uint8_t i=0;
	gets(tempExpiryDate);
	uint8_t ExpirySize= strlen(tempExpiryDate);
	
	if (ExpirySize==5)
	{
		if (tempExpiryDate[0]<='1' && tempExpiryDate[1]<='9'  && 
			tempExpiryDate[2]=='/' && tempExpiryDate[3]<='9'  && 
			tempExpiryDate[4]<='9')
		{
			for (i=0; i<ExpirySize ;i++)
			{
				cardData->cardExpirationDate[i] = tempExpiryDate[i];
			}
			return OK;
		}
		else
		{
			return WRONG_EXP_DATE;
		}
	}
	else 
	{
		return WRONG_EXP_DATE;
	}
}

/***********************************************************************************************************************/
/***********************************************************************************************************************/
/**************************          Function Name:        getCardPAN               ************************************/
/**************************          Input Arguments:      Pointer To Struct        ************************************/
/**************************          Output Arguments:     Object From Enum			************************************/
/**************************         												************************************/
/********************         Function Description: This function asks for the Primary     *****************************/
/********************							    Account Number and store it    		   *****************************/
/********************		                        into the card data which is a pointer  *****************************/
/********************								to a structure has an array 		   *****************************/
/********************						        named (primaryAccountNumber).          *****************************/
/********************						        A temporary array made just to          *****************************/
/********************						        obtain a pre checks before saving       *****************************/
/********************						        it into the main array the             *****************************/
/***********************************************************************************************************************/
/***********************************************************************************************************************/

EN_cardError_t getCardPAN(ST_cardData_t *cardData)
{
	uint8_t tempAccountNumber[25]={0};
	uint8_t i=0;
	uint8_t j=0;
	uint8_t flag=0;
	
	gets(tempAccountNumber);
	uint8_t AccountSize= strlen(tempAccountNumber);

	if (AccountSize>=16 && AccountSize<=20)
	{
		
		for (i=0; i<AccountSize ;i++)
		{
			if (tempAccountNumber[i]>='0' && tempAccountNumber[i] <= '9')		
			{
				
			}
			else 
			{	
			 flag=1;
			}
		}
		
		if (flag==1)
		{
			return WRONG_PAN;	
		}
		else if (flag==0)
		{
		for (j=0; j<=AccountSize ;j++)
			{
				cardData->primaryAccountNumber[j] = tempAccountNumber[j];
			}
				
				return OK;
		}
		
	}
	else
		{
			return WRONG_PAN;
		}
	
}




	